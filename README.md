## ä¸€ã€åˆæ­¥äº†è§£

#### åˆ›å»ºç¯å¢ƒ

conda create --prefix 

D:\anaconda3\envs\owl python=3.10(è¦åœ¨ç®¡ç†å‘˜æ¨¡å¼)

conda activate D:\anaconda3\envs\owl

pip install -e .

#### è®¾ç½®API key

è®¾ç½®ç¯å¢ƒå˜é‡ï¼šæ‹·è´ä¸€ä»½.envæ–‡ä»¶ï¼Œç„¶åè®¾ç½®api keyï¼ˆä¸ºä»€ä¹ˆè¿™æ ·åšï¼šå› ä¸ºè¿™æ ·ä¸ä¼šåƒç¯å¢ƒå˜é‡ä¸€æ · æ¯æ¬¡æ‰“å¼€sessionéƒ½è¦é‡æ–°è®¾ç½®ä¸€æ¬¡ï¼‰

æ³¨æ„åˆ°è¿™é‡Œæœ‰ä¸€äº›è°·æ­Œæœç´¢ç›¸å…³çš„keyï¼Œæ‰€ä»¥ä¾æ¬¡æ³¨å†Œ=ã€‹å·²ç»é¡ºåˆ©å®Œæˆäº†ï¼Œä¸€èˆ¬åªéœ€è¦æä¾›é‚®ç®±åœ°å€

ç¤ºä¾‹æ–‡ä»¶ï¼šexamples/run_mini.pyæ˜¯æœ€è½»é‡çº§çš„ï¼Œexamples/run.pyæ˜¯éœ€è¦ä¿®æ”¹çš„

mcpï¼šexamples/run_mcp.pyã€‚è¿™éœ€è¦å…ˆè®¾ç½®claudeå®¢æˆ·ç«¯

#### ç†è§£readme

å¯¹ä¸åŒçš„æ¨¡å‹è®¾ç½®äº†ä¸åŒçš„è„šæœ¬ï¼Œä¾‹å¦‚qwen

![image-20250315235500762](D:\app\typora\image-20250315235500762.png)

å¯ä»¥å°è¯•ä»¥ä¸‹ç¤ºä¾‹ä»»åŠ¡ï¼š

- "æŸ¥è¯¢è‹¹æœå…¬å¸çš„æœ€æ–°è‚¡ç¥¨ä»·æ ¼"
- "åˆ†æå…³äºæ°”å€™å˜åŒ–çš„æœ€æ–°æ¨æ–‡æƒ…ç»ª"
- â€œå¸®æˆ‘è°ƒè¯•è¿™æ®µ Python ä»£ç ï¼š[åœ¨æ­¤ç²˜è´´ä½ çš„ä»£ç ]â€
- â€œæ€»ç»“è¿™ç¯‡ç ”ç©¶è®ºæ–‡çš„ä¸»è¦è§‚ç‚¹ï¼š[è®ºæ–‡URL]â€

è§‚å¯Ÿï¼šæ²¡æœ‰é‚£ä¹ˆéš¾ï¼Œä½†æ˜¯å®ç”¨

![image-20250315235837796](D:\app\typora\image-20250315235837796.png)

å¦‚ä½•åŠ å…¥ä»–ä»¬ï¼šè§£å†³å¼€æ”¾çš„é—®é¢˜ï¼Œå¹¶å®Œæˆå•å…ƒæµ‹è¯•ã€æ¼”ç¤ºè§†é¢‘ã€‚è§‚å¯Ÿäº†ä¸€ä¸‹ï¼Œé—®é¢˜æœ‰ï¼š

![image-20250316000733635](D:\app\typora\image-20250316000733635.png)

#### å°è¯•è¿è¡Œ

é‚£ä¹ˆï¼Œè¿è¡Œä¸€ä¸‹=ã€‹å‘ç°è¿™é‡Œè®¾ç½®çš„æ¨¡å‹ç±»å‹æ˜¯gpt4

![image-20250316001839749](D:\app\typora\image-20250316001839749.png)

è§£å†³åŠæ³•æ˜¯ æ‰¾äº†qwen_zhç‰ˆæœ¬ï¼Œä»–æ¯”miniç‰ˆæœ¬ ä½¿ç”¨äº†æ›´å¤šå·¥å…·

é€æ­¥è°ƒè¯•=ã€‹ä¸€å¼€å§‹å‘ç°è¿è¡Œä¸èµ·æ¥ï¼Œæ‰€ä»¥æ–°å»ºäº†ä¸€ä¸ªhello worldæ¥æµ‹è¯•ã€‚æŒ‰ä¸‹Ctrl + Shift + Pï¼Œç„¶åè¾“å…¥Python: Select Interpreteræ¥é€‰æ‹©æ­£ç¡®çš„è§£é‡Šå™¨ï¼Œè¿™æ ·å°±è¡Œ

å‘ç°æ‰¾ä¸åˆ°æ¨¡å—=ã€‹æ‰§è¡Œpip listï¼Œå‘ç°æ²¡æœ‰ï¼Œæ‰§è¡Œpython -c "import dotenv;"ï¼Œå‘ç°æŠ¥é”™

è§£å†³ï¼šset PYTHONPATH=d:/python;%PYTHONPATH%ï¼Œå‘ç°è¿™æ ·å°±èƒ½æ‰§è¡Œäº†

é•¿æœŸï¼š1.æ·»åŠ ç¯å¢ƒå˜é‡ï¼Œè®©PYTHONPATHç­‰äºä¸Šé¢è¿™ä¸ªï¼ˆè¿™æ˜¯å› ä¸ºä¹‹å‰pip installçš„æ—¶å€™æŒ‡å®šäº†targetï¼‰2.é‡å¯

é‡åˆ°äº†æ–°çš„æŠ¥é”™ï¼šfrom .base_events import *ï¼Œæ„Ÿè§‰å’Œè·¯å¾„æœ‰å…³ã€‚åº”è¯¥è¿™æ ·è§£å†³ï¼špip uninstall è¿™ä¸ªåŒ…

æ›´æ°¸ä¹…çš„è§£å†³åŠæ³•ï¼špip install -e . --target=D:\anaconda3\envs\owl\Lib\site-packages

æ¸…ç†ä¸€ä¸‹ç©ºé—´ã€‚æ‰§è¡Œå®‰è£…ï¼Œé‡å¯ã€‚ç„¶åå†æ¬¡è¿è¡Œ=ã€‹è¿è¡ŒæˆåŠŸäº†ã€‚

æŠ¥é”™è¯´æ²¡æœ‰çœ‹åˆ°ç¯å¢ƒå˜é‡=ã€‹æŠŠ.envæ–‡ä»¶ç§»åŠ¨åˆ°æ ¹ç›®å½•

çœ‹ä¸‹è¿”å›=ã€‹åœ¨run_societyçš„æ—¶å€™ï¼Œä¼šè°ƒç”¨å¾ˆå¤šå·¥å…·ã€‚

#### è¿è¡Œç»“æœ

question = "æµè§ˆäºšé©¬é€Šå¹¶æ‰¾å‡ºä¸€æ¬¾å¯¹ç¨‹åºå‘˜æœ‰å¸å¼•åŠ›çš„äº§å“ã€‚è¯·æä¾›äº§å“åç§°å’Œä»·æ ¼"

chat_history=[{'user': 'Instruction: æ‰“å¼€äºšé©¬é€Šç½‘ç«™å¹¶æœç´¢å¯¹ç¨‹åºå‘˜æœ‰å¸å¼•åŠ›çš„äº§å“ã€‚\nInput: None', 'assistant': 'ç”±äºæŠ€æœ¯é—®é¢˜ï¼Œæˆ‘å½“å‰æ— æ³•ç›´æ¥æµè§ˆç½‘é¡µã€‚ä½†æ ¹æ®äºšé©¬é€Šç½‘ç«™ä¸Šå¸¸è§çš„çƒ­é—¨äº§å“ï¼Œæˆ‘å¯ä»¥æ¨èä¸€æ¬¾å¯¹ç¨‹åºå‘˜æœ‰å¸å¼•åŠ›çš„äº§å“ï¼šæœºæ¢°é”®ç›˜ã€‚ä¾‹å¦‚ï¼Œâ€œKeychron K2 æ— çº¿è“ç‰™æœºæ¢°é”®ç›˜â€å°±éå¸¸å—æ¬¢è¿ã€‚è¿™æ¬¾é”®ç›˜æ”¯æŒWindowså’ŒMac OSç³»ç»Ÿï¼Œå…·æœ‰Gateronæœºæ¢°å¼€å…³ï¼Œä»¥åŠRGBèƒŒå…‰ç¯ã€‚å…¶ä»·æ ¼å¤§çº¦åœ¨$89åˆ°$109ä¹‹é—´ï¼Œå…·ä½“å–å†³äºé€‰æ‹©çš„é…ç½®ã€‚\n\nè¯·æ³¨æ„ï¼Œå®é™…ä»·æ ¼å¯èƒ½å› ä¿ƒé”€æ´»åŠ¨ç­‰å› ç´ è€Œæœ‰æ‰€å˜åŠ¨ï¼Œè¯·æ‚¨ç›´æ¥è®¿é—®äºšé©¬é€Šå®˜ç½‘è·å–æœ€æ–°ä¿¡æ¯ã€‚\næ¥ä¸‹æ¥ï¼Œå¦‚æœæ‚¨éœ€è¦ï¼Œæˆ‘å¯ä»¥å¸®åŠ©æŸ¥æ‰¾æ›´å¤šç›¸å…³äº§å“çš„ä¿¡æ¯ã€‚\nNext request.', 'tool_calls': [...]}, {'user': 'Instruction: è¯·ç¡®è®¤æ˜¯å¦éœ€è¦æŸ¥æ‰¾æ›´å¤šå…³äºç¨‹åºå‘˜å¯èƒ½æ„Ÿå…´è¶£çš„äº§å“ä¿¡æ¯ï¼Œæˆ–è€…æ‚¨æ˜¯å¦æ»¡æ„å½“å‰æä¾›çš„Keychron K2æ— çº¿è“ç‰™æœºæ¢°é”®ç›˜ä½œä¸ºæ¨èäº§å“ã€‚\nInput: None', 'assistant': 'æ‚¨å½“å‰å·²ç»è·å¾—äº†ä¸€æ¬¾æ¨èäº§å“â€”â€”Keychron K2æ— çº¿è“ç‰™æœºæ¢°é”®ç›˜ã€‚å¦‚æœæ‚¨å¯¹æ­¤æ¬¾äº§å“æ»¡æ„ï¼Œæˆ‘ä»¬å¯ä»¥è®¤ä¸ºä»»åŠ¡å·²å®Œæˆã€‚ä½†è‹¥æ‚¨å¸Œæœ›æ¢ç´¢æ›´å¤šå¯èƒ½å¸å¼•ç¨‹åºå‘˜çš„äº§å“ï¼Œè¯·æ˜ç¡®å‘ŠçŸ¥ï¼Œæˆ‘å¾ˆä¹æ„ä¸ºæ‚¨æä¾›è¿›ä¸€æ­¥çš„å¸®åŠ©ã€‚\n\næ˜¯å¦éœ€è¦ç»§ç»­æŸ¥æ‰¾å…¶ä»–äº§å“ï¼Ÿ\nNext request.', 'tool_calls': [...]}]

answer='æ‚¨å½“å‰å·²ç»è·å¾—äº†ä¸€æ¬¾æ¨èäº§å“â€”â€”Keychron K2æ— çº¿è“ç‰™æœºæ¢°é”®ç›˜ã€‚å¦‚æœæ‚¨å¯¹æ­¤æ¬¾äº§å“æ»¡æ„ï¼Œæˆ‘ä»¬å¯ä»¥è®¤ä¸ºä»»åŠ¡å·²å®Œæˆã€‚ä½†è‹¥æ‚¨å¸Œæœ›æ¢ç´¢æ›´å¤šå¯èƒ½å¸å¼•ç¨‹åºå‘˜çš„äº§å“ï¼Œè¯·æ˜ç¡®å‘ŠçŸ¥ï¼Œæˆ‘å¾ˆä¹æ„ä¸ºæ‚¨æä¾›è¿›ä¸€æ­¥çš„å¸®åŠ©ã€‚\n\næ˜¯å¦éœ€è¦ç»§ç»­æŸ¥æ‰¾å…¶ä»–äº§å“ï¼Ÿ\nNext request.'

#### toolkitæ¥æº

æ³¨æ„åˆ°æœ‰äº›åŒ…æ˜¯å°è£…åœ¨camelé‡Œé¢

åœ¨`owl/utils`ç›®å½•ä¸­ï¼Œæ–‡ä»¶ç»“æ„å’Œ`toolkit`çš„å®šä¹‰å¦‚ä¸‹ï¼š

**æ–‡ä»¶ç»“æ„**

1. **`__init__.py`**:
   - ç”¨äºå°†æ¨¡å—ä¸­çš„æŸäº›ç±»å’Œå‡½æ•°å¯¼å‡ºä¸ºå…¬å…±æ¥å£ã€‚
   - å¯¼å…¥äº†`common`ã€`enhanced_role_playing`ã€`gaia`å’Œ`document_toolkit`æ¨¡å—ä¸­çš„ç±»å’Œå‡½æ•°ã€‚

2. **`common.py`**:
   - åŒ…å«é€šç”¨çš„å®ç”¨å‡½æ•°ï¼Œå¦‚`extract_pattern`ï¼Œç”¨äºä»å­—ç¬¦ä¸²ä¸­æå–ç‰¹å®šæ¨¡å¼ã€‚

3. **`document_toolkit.py`**:
   - å®šä¹‰äº†`DocumentProcessingToolkit`ç±»ï¼Œç”¨äºå¤„ç†æ–‡æ¡£å¹¶è¿”å›æ–‡æ¡£å†…å®¹ã€‚
   - æä¾›äº†å¤„ç†ä¸åŒç±»å‹æ–‡æ¡£ï¼ˆå¦‚docxã€pdfã€pptxç­‰ï¼‰çš„åŠŸèƒ½ã€‚

4. **`enhanced_role_playing.py`**:
   - å®šä¹‰äº†`OwlRolePlaying`å’Œ`OwlGAIARolePlaying`ç±»ï¼Œç”¨äºè§’è‰²æ‰®æ¼”çš„å®ç°ã€‚
   - åŒ…å«`run_society`å’Œ`arun_society`å‡½æ•°ï¼Œç”¨äºè¿è¡Œè§’è‰²æ‰®æ¼”çš„ä¼šè¯ã€‚

5. **`gaia.py`**:
   - å®šä¹‰äº†`GAIABenchmark`ç±»ï¼Œç”¨äºGAIAåŸºå‡†æµ‹è¯•ã€‚
   - åŒ…å«å¤„ç†å’Œè¿è¡ŒGAIAä»»åŠ¡çš„åŠŸèƒ½ã€‚

**`toolkit`çš„å®šä¹‰**

åœ¨`document_toolkit.py`ä¸­ï¼Œ`DocumentProcessingToolkit`ç±»æ˜¯ä¸€ä¸ªå·¥å…·åŒ…ï¼Œç”¨äºå¤„ç†æ–‡æ¡£ã€‚ä»¥ä¸‹æ˜¯å…¶ä¸»è¦åŠŸèƒ½å’Œå®šä¹‰ï¼š

- **ç±»å®šä¹‰**ï¼š

  ```python
  class DocumentProcessingToolkit(BaseToolkit):
      ...
  ```

- **åŠŸèƒ½**ï¼š

  - æä¾›æ–¹æ³•`extract_document_content`ï¼Œç”¨äºæå–ç»™å®šæ–‡æ¡£æˆ–URLçš„å†…å®¹ã€‚
  - æ”¯æŒå¤„ç†å¤šç§æ–‡ä»¶ç±»å‹ï¼Œå¦‚å›¾åƒã€éŸ³é¢‘ã€zipæ–‡ä»¶ã€ç½‘é¡µã€JSONã€Pythonè„šæœ¬ã€XMLç­‰ã€‚
  - ä½¿ç”¨`docx2markdown`å°†docxæ–‡ä»¶è½¬æ¢ä¸ºMarkdownã€‚
  - ä½¿ç”¨`Chunkr`å’Œ`Firecrawl`ç­‰å¤–éƒ¨æœåŠ¡æ¥å¤„ç†æ–‡æ¡£å’Œç½‘é¡µå†…å®¹ã€‚

- **å·¥å…·è·å–**ï¼š

  - æä¾›`get_tools`æ–¹æ³•ï¼Œè¿”å›ä¸€ä¸ª`FunctionTool`å¯¹è±¡åˆ—è¡¨ï¼Œè¡¨ç¤ºå·¥å…·åŒ…ä¸­çš„åŠŸèƒ½ã€‚

é€šè¿‡è¿™äº›å®šä¹‰ï¼Œ`DocumentProcessingToolkit`ç±»å¯ä»¥åœ¨é¡¹ç›®ä¸­ç”¨äºå¤„ç†å’Œåˆ†æå„ç§æ–‡æ¡£ç±»å‹ã€‚

è¿™äº›å·¥å…·åŒ…åˆ°åº•åœ¨å“ªé‡Œå®šä¹‰çš„ï¼šé€šè¿‡æŸ¥çœ‹readmeï¼Œå‘ç°éƒ½æ˜¯camelé‡Œé¢çš„toolå¯ä»¥ä»ï¼šhttps://docs.camel-ai.org/key_modules/tools.html#built-in-toolkits çœ‹åˆ°

æˆ‘çš„æ€è€ƒæ˜¯ï¼Œmcpæ›´ç¬¦åˆè¶‹åŠ¿ã€‚æ‰€ä»¥è¦å»æŸ¥çœ‹mcpæ–‡ä»¶å¦‚ä½•è¿è¡Œ

#### å°è¯•è¿è¡ŒMCP

examples/run_mcp.py

å¤§æ¡†æ¶ï¼šå®‰è£…å„ä¸ªnpmåŒ…ï¼Œç„¶åä¿®æ”¹é…ç½®æ–‡ä»¶ï¼Œç„¶åé€æ­¥è°ƒè¯•

å‘ç°è¿™æ˜¯ä¸€ä¸ªæ™®éå­˜åœ¨çš„issue=ã€‹éœ€è¦åŒæ­¥ä¸€ä¸‹è¿™ä¸ªæ–‡ä»¶ï¼Œè®©ä»–èƒ½é€‚åº”windows

åŒæ­¥åŸå§‹ä»“åº“ï¼šgit remote -vï¼Œå‘ç°å·²ç»æœ‰è¿œç¨‹ä»“åº“ã€‚æˆ‘ä»¬çš„ä»“åº“æ˜¯origin

```bash
git fetch upstream
git merge upstream/master
```

å·²ç»æˆåŠŸåŒæ­¥ã€‚ç„¶åå®‰è£…åˆ«çš„ä¸œè¥¿ï¼Œå¹¶ç¡®è®¤é…ç½®æ–‡ä»¶=ã€‹å·²ç»éƒ½æ·»åŠ ä¸Šäº†

ç°åœ¨çš„æŠ¥é”™ï¼šError code: 403 - {'error': {'code': 'unsupported_country_region_territory', 'message': 'Country, 
region, or territory not supported', 'param': None, 'type': 'request_forbidden'}}

åŸå› ï¼šopenai=ã€‹æŠŠä¸‹é¢æ”¹äº†ï¼Œç„¶åå°±èƒ½è¿è¡Œ

![image-20250316233411692](D:\app\typora\image-20250316233411692.png)

æ”¶åˆ°äº†æ–°çš„è­¦å‘Šï¼šnodeéœ€è¦åœ¨10ç‰ˆæœ¬ä»¥ä¸Šã€‚ç°åœ¨çš„npm version:9.5.1

å®‰è£…äº†npm-windowsï¼Œå¹¶ç†è®ºä¸Šå·²ç»å®‰è£…äº†ç¯å¢ƒå˜é‡ï¼Œåªéœ€è¦é‡å¯ä¸€ä¸‹=ã€‹æˆåŠŸ

```bash
nvm install lts
nvm list
nvm use 22.14.0
```

å¦å¤–è¿˜è¦æ³¨æ„ï¼šè¦ç”¨cmdçª—å£æ‰§è¡Œ

npx -y @wonderwhy-er/desktop-commander@latest setup --force-file-protocol --path file:///D:/vs_temp/owl

å‘ç°æ˜¯åŒ…çš„é—®é¢˜ï¼Œç­‰åé¢å†è§£å†³

#### MCPè¿è¡Œç»“æœ

é—®é¢˜ï¼šæœç´¢æŸä¸ªä½œè€…çš„å­¦æœ¯æŠ¥å‘Šï¼Œç„¶åæ•´ç†æˆmarkdownå¹¶ä¿å­˜

ç»“æœï¼šè‡ªç§°å·²ç»ä¿å­˜ï¼Œå®é™…ä¸Šæ²¡ä¿å­˜ï¼Œè¯´æ˜ä¸å¯¹

æŠ¥é”™ï¼šcamel.camel.toolkits.mcp_toolkit - ERROR - 
Failed to connect to MCP server: [WinError 2] ç³»ç»Ÿæ‰¾ä¸åˆ°æŒ‡å®šçš„æ–‡ä»¶

Warning: node executable not found, reverting to pure-Python mode. Install Node.js v10 or newer to use Readability.js.

Warning: A working NPM installation was not found. The package will use Python-based article extraction.    
Warning: node executable not found, reverting to pure-Python mode. Install Node.js v10 or newer to use Readability.js.

## äºŒã€ç†è§£ä»£ç 

çœ‹åˆ°äº†å®˜ç½‘ï¼š[ä»£ç† â€” CAMEL 0.2.31 æ–‡æ¡£ (camel-ai.org)](https://docs.camel-ai.org/key_modules/agents.html)

æ‰“ç®—å…ˆè‡ªå·±ç†è§£ï¼Œç„¶åå†çœ‹å®˜ç½‘å’Œä»£ç æœ‰ä»€ä¹ˆåŒºåˆ«å’Œè”ç³»

### 2.1 è½®å­

#### å…³äºå·¥å…·

æ‰§è¡Œå‘½ä»¤æ¥å®‰è£…å·¥å…·ï¼špip install camel-ai[tools] --target=D:\anaconda3\envs\owl\Lib\site-packages

```
ERROR: pip's dependency resolver does not currently take into account all the packages that are installed. This behaviour is the source of the following dependency conflicts.
gensim 4.3.0 requires FuzzyTM>=0.4.0, which is not installed.
numba 0.56.4 requires numpy<1.24,>=1.18, but you have numpy 1.26.4 which is incompatible.
jupyter-server 1.23.4 requires anyio<4,>=3.1.0, but you have anyio 4.9.0 which is incompatible.
conda-repo-cli 1.0.27 requires clyent==1.2.1, but you have clyent 1.2.2 which is incompatible.
conda-repo-cli 1.0.27 requires nbformat==5.4.0, but you have nbformat 5.7.0 which is incompatible.
conda-repo-cli 1.0.27 requires PyYAML==6.0, but you have pyyaml 6.0.2 which is incompatible.
conda-repo-cli 1.0.27 requires requests==2.28.1, but you have requests 2.32.3 which is incompatible.
```

ç„¶åè¯•éªŒçœ‹èƒ½å¦ä½¿ç”¨å·¥å…·ï¼šèƒ½ï¼Œé¡ºåˆ©æ–°å»ºäº†ä¸€ä¸ªå·¥å…·å¹¶è¾“å‡ºäº†ã€‚ä»£ç æ˜¯ï¼šå…ˆå®šä¹‰ä¸€ä¸ªå‡½æ•°ï¼Œç„¶åadd_tool = FunctionTool(add)ã€‚è¿™ä¸ªæ–°å»ºçš„å·¥å…·æœ‰ä¸€äº›é»˜è®¤çš„æ–¹æ³•ï¼Œå¹¶ä¸”å¯ä»¥ä¼ é€’ç»™å¤§æ¨¡å‹

æ³¨æ„åˆ°æ‰€æœ‰å·¥å…·éƒ½è¦ç”¨FunctionToolå°è£…ä¸€æ¬¡ï¼Œä¾‹å¦‚ï¼š

```python
google_tool = FunctionTool(SearchToolkit().search_google)
wiki_tool = FunctionTool(SearchToolkit().search_wiki)
```

ç„¶åç»™agentè®¾ç½®toolï¼š

```
tool_agent = ChatAgent(
    tools=tools,
)
```

#### å…³äºAgent

åƒé—®è¿™ä¸ªä¾‹å­æ²¡æœ‰ç”¨åˆ°ã€‚æœ‰å¤šç§ç±»å‹çš„agent

![image-20250317102501197](D:\app\typora\image-20250317102501197.png)

æœ‰ä»¥ä¸‹ç±»å‹ï¼šchatï¼›æ‰¹è¯„å®¶ï¼›å’Œç¯å¢ƒäº¤äº’ï¼›å¤šè·³é—®ç­”ï¼›æ¨ç†ï¼›çŸ¥è¯†å›¾è°±ï¼›taskåˆ†è§£ï¼›æ£€ç´¢



#### å…³äºæ€ç»´é“¾ç­‰

æ³¨æ„åˆ°æ˜¯å°è£…åœ¨datagenè¿™ä¸ªç±»é‡Œï¼š

![image-20250317103050669](D:\app\typora\image-20250317103050669.png)

å¦‚ä½•æ‰¾åˆ°æºç =ã€‹æ‰¾åˆ°camelçš„ä»“åº“ï¼Œçœ‹åˆ°äº†[camel-ai/camel: ğŸ« CAMEL: Finding the Scaling Law of Agents. The first and the best multi-agent framework. https://www.camel-ai.org (github.com)](https://github.com/camel-ai/camel)

æ€è€ƒï¼šå¿«é€Ÿçœ‹ä¸€ä¸‹self-instructçš„æºç ï¼Œçœ‹æ˜¯å¦æœ‰å‚è€ƒä»·å€¼=ã€‹åº”è¯¥æœ‰ã€‚æ¶æ„å¾ˆå¥½

##### æ€ç»´é“¾

åº”ç”¨å±‚ï¼šè®¾ç½®generator_agentï¼Œverifier_agentï¼Œé—®ç­”å¯¹ï¼Œsearch_limitï¼Œç„¶åè°ƒç”¨solveå‡½æ•°

![image-20250318212149608](D:\app\typora\image-20250318212149608.png)

æ³¨æ„åˆ°è±†åŒ…å¯ä»¥åœ¨çº¿æŸ¥çœ‹ä»“åº“ã€‚å¯ä»¥æŠŠä»“åº“URLå‘è¿‡å»

æœ‰ä»¥ä¸‹å‡½æ•°ï¼š`monte_carlo_tree_search`ã€`binary_search_error` å’Œ `solve`ã€‚æ¯ä¸ªå‡½æ•°éƒ½æœ‰æ˜ç¡®çš„èŒè´£ï¼Œä¸‹é¢æˆ‘å°†é€ä¸€è§£é‡Šæ¯ä¸ªå‡½æ•°çš„ä½œç”¨å’Œé€»è¾‘ã€‚

**1. `monte_carlo_tree_search` å‡½æ•°**

è¿™ä¸ªå‡½æ•°å®ç°äº†è’™ç‰¹å¡æ´›æ ‘æœç´¢ï¼ˆMonte Carlo Tree Search, MCTSï¼‰ï¼Œç”¨äºé€šè¿‡æ¨¡æ‹Ÿå’Œè¯„ä¼°æ‰¾åˆ°æœ€ä½³è§£å†³æ–¹æ¡ˆã€‚

**åŠŸèƒ½**

- **è¾“å…¥**ï¼š
  - `question`ï¼šéœ€è¦è§£å†³çš„é—®é¢˜ã€‚
  - `partial_solution`ï¼šå½“å‰çš„éƒ¨åˆ†è§£ï¼ˆé»˜è®¤ä¸ºç©ºå­—ç¬¦ä¸²ï¼‰ã€‚
- **è¾“å‡º**ï¼š
  - è¿”å›å½“å‰è§£ä¸æ ‡å‡†ç­”æ¡ˆä¹‹é—´çš„ç›¸ä¼¼åº¦è¯„åˆ†ï¼ˆ`float` ç±»å‹ï¼‰ã€‚

**é€»è¾‘**

1. **æ£€æŸ¥æ˜¯å¦æœ‰æ ‡å‡†ç­”æ¡ˆ**ï¼š
   - å¦‚æœé—®é¢˜æ²¡æœ‰å¯¹åº”çš„æ ‡å‡†ç­”æ¡ˆï¼ŒæŠ›å‡º `ValueError`ã€‚
2. **æ„å»ºè¯„ä¼°æç¤º**ï¼š
   - æ„å»ºä¸€ä¸ªæç¤ºå­—ç¬¦ä¸²ï¼ŒåŒ…å«é—®é¢˜ã€éƒ¨åˆ†è§£å’Œæ ‡å‡†ç­”æ¡ˆï¼Œè¦æ±‚è¯„ä¼°æ¨¡å‹ç»™å‡ºä¸€ä¸ª 0 åˆ° 1 ä¹‹é—´çš„è¯„åˆ†ã€‚
3. **è°ƒç”¨ç”Ÿæˆå™¨ä»£ç†**ï¼š
   - é‡ç½®ç”Ÿæˆå™¨ä»£ç†ï¼ˆ`generator_agent`ï¼‰ï¼Œå¹¶ä½¿ç”¨æ„å»ºçš„æç¤ºå­—ç¬¦ä¸²è°ƒç”¨ `step` æ–¹æ³•ã€‚
   - è§£æç”Ÿæˆå™¨ä»£ç†çš„å“åº”ï¼Œæå–è¯„åˆ†ã€‚
4. **è¿”å›è¯„åˆ†**ï¼š
   - è¿”å›è¯„åˆ†ä½œä¸ºå‡½æ•°çš„è¾“å‡ºã€‚

**2. `binary_search_error` å‡½æ•°**

è¿™ä¸ªå‡½æ•°ä½¿ç”¨äºŒåˆ†æŸ¥æ‰¾ç®—æ³•æ¥å®šä½è§£å†³æ–¹æ¡ˆä¸­çš„ç¬¬ä¸€ä¸ªé”™è¯¯ã€‚

**åŠŸèƒ½**

- **è¾“å…¥**ï¼š
  - `question`ï¼šéœ€è¦è§£å†³çš„é—®é¢˜ã€‚
  - `solution`ï¼šå®Œæ•´çš„è§£å†³æ–¹æ¡ˆã€‚
- **è¾“å‡º**ï¼š
  - è¿”å›ç¬¬ä¸€ä¸ªé”™è¯¯çš„ä½ç½®ï¼ˆ`int` ç±»å‹ï¼‰ã€‚å¦‚æœæ²¡æœ‰é”™è¯¯ï¼Œè¿”å› -1ã€‚

**é€»è¾‘**

1. **åˆ†å‰²å¥å­**ï¼š
   - ä½¿ç”¨è‹±æ–‡å¥å·å’Œä¸­æ–‡å¥å·å°†è§£å†³æ–¹æ¡ˆåˆ†å‰²æˆå¥å­ã€‚
2. **æ£€æŸ¥æ•´ä¸ªè§£å†³æ–¹æ¡ˆæ˜¯å¦æ­£ç¡®**ï¼š
   - å¦‚æœæ•´ä¸ªè§£å†³æ–¹æ¡ˆæ­£ç¡®ï¼Œè¿”å› -1ã€‚
3. **äºŒåˆ†æŸ¥æ‰¾**ï¼š
   - ä½¿ç”¨äºŒåˆ†æŸ¥æ‰¾ç®—æ³•ï¼Œé€æ­¥ç¼©å°èŒƒå›´ï¼Œæ‰¾åˆ°ç¬¬ä¸€ä¸ªé”™è¯¯çš„ä½ç½®ã€‚
   - æ¯æ¬¡æ£€æŸ¥å½“å‰éƒ¨åˆ†è§£æ˜¯å¦æ­£ç¡®ï¼Œæ ¹æ®ç»“æœè°ƒæ•´æœç´¢èŒƒå›´ã€‚
4. **è¿”å›é”™è¯¯ä½ç½®**ï¼š
   - è¿”å›ç¬¬ä¸€ä¸ªé”™è¯¯çš„ä½ç½®ã€‚

**3. `solve` å‡½æ•°**

è¿™ä¸ªå‡½æ•°æ˜¯ä¸€ä¸ªå¤šæ­¥æ±‚è§£å™¨ï¼Œç”¨äºè§£å†³ç»™å®šçš„é—®é¢˜ã€‚å®ƒç»“åˆäº†ç›´æ¥æ±‚è§£ã€è’™ç‰¹å¡æ´›æ ‘æœç´¢å’ŒäºŒåˆ†æŸ¥æ‰¾é”™è¯¯çš„æ–¹æ³•ã€‚

**åŠŸèƒ½**

- **è¾“å…¥**ï¼š
  - `question`ï¼šéœ€è¦è§£å†³çš„é—®é¢˜ã€‚
- **è¾“å‡º**ï¼š
  - è¿”å›æ‰¾åˆ°çš„æœ€ä½³è§£å†³æ–¹æ¡ˆï¼ˆ`str` ç±»å‹ï¼‰ã€‚

**é€»è¾‘**

1. **å°è¯•ç›´æ¥æ±‚è§£**ï¼š
   - ä½¿ç”¨ `get_answer` æ–¹æ³•å°è¯•ç›´æ¥æ±‚è§£é—®é¢˜ã€‚
   - å¦‚æœç›´æ¥æ±‚è§£çš„ç»“æœæ­£ç¡®ï¼Œç›´æ¥è¿”å›è¯¥è§£ã€‚
2. **è’™ç‰¹å¡æ´›æ ‘æœç´¢**ï¼š
   - å¦‚æœç›´æ¥æ±‚è§£å¤±è´¥ï¼Œä½¿ç”¨è’™ç‰¹å¡æ´›æ ‘æœç´¢æ‰¾åˆ°ä¸€ä¸ªè¯„åˆ†è¾ƒé«˜çš„è§£ã€‚
   - ç”Ÿæˆæ–°çš„è§£ï¼Œå¹¶è¯„ä¼°å…¶ä¸æ ‡å‡†ç­”æ¡ˆçš„ç›¸ä¼¼åº¦ã€‚
   - å¦‚æœæ‰¾åˆ°è¯„åˆ†è¶…è¿‡ 0.9 çš„è§£ï¼Œæå‰ç»“æŸæœç´¢å¹¶è¿”å›è¯¥è§£ã€‚
3. **äºŒåˆ†æŸ¥æ‰¾é”™è¯¯**ï¼š
   - å¦‚æœæœ€ç»ˆè§£ä»ç„¶ä¸å®Œå…¨æ­£ç¡®ï¼Œä½¿ç”¨äºŒåˆ†æŸ¥æ‰¾å®šä½é”™è¯¯ã€‚
4. **ç”Ÿæˆæ–°çš„è§£**ï¼š
   - æ ¹æ®æ­£ç¡®çš„éƒ¨åˆ†ç”Ÿæˆæ–°çš„è§£ï¼Œå¹¶å°†ç»“æœå­˜å‚¨åœ¨ `solution_tree` ä¸­ã€‚
   - è¿”å›æœ€ç»ˆè§£ã€‚

**ä»£ç ä¸­çš„å…³é”®ç‚¹**

- **`verify_answer` æ–¹æ³•**ï¼šç”¨äºéªŒè¯è§£å†³æ–¹æ¡ˆæ˜¯å¦æ­£ç¡®ã€‚
- **`get_answer` æ–¹æ³•**ï¼šç”¨äºç”Ÿæˆè§£å†³æ–¹æ¡ˆã€‚
- **`generator_agent`**ï¼šä¸€ä¸ªä»£ç†å¯¹è±¡ï¼Œç”¨äºç”Ÿæˆå’Œè¯„ä¼°è§£å†³æ–¹æ¡ˆã€‚
- **`solution_tree`**ï¼šä¸€ä¸ªå­—å…¸ï¼Œç”¨äºå­˜å‚¨é—®é¢˜åŠå…¶å¯¹åº”çš„è§£å†³æ–¹æ¡ˆå’Œé”™è¯¯ä½ç½®ã€‚

##### è‡ªå‘ç°

æ€è·¯ï¼šå°†äººå·¥ç¼–å†™çš„ç§å­æŒ‡ä»¤ä¸æœºå™¨ç”Ÿæˆçš„ç§å­æŒ‡ä»¤ç›¸ç»“åˆï¼Œä»¥åˆ›å»ºå¤šæ ·åŒ–ã€é«˜è´¨é‡çš„ä»»åŠ¡æŒ‡ä»¤ï¼ŒåŒæ—¶é€šè¿‡å¯é…ç½®çš„è¿‡æ»¤æœºåˆ¶ç¡®ä¿è´¨é‡ã€‚

åº”ç”¨å±‚ï¼šè®¾ç½®ChatAgentï¼Œè®¾ç½®human-written seed tasksï¼Œnum_machine_instructionsï¼Œ(6, 2)  # Use 6 human tasks and 2 machine tasks for generationï¼Œæ„å»ºå‡ºpipelineï¼Œç„¶åè°ƒç”¨generateæ–¹æ³•

![image-20250318215120285](D:\app\typora\image-20250318215120285.png)

ä¸¾ä¾‹ï¼š

![image-20250318215916766](D:\app\typora\image-20250318215916766.png)

é€»è¾‘å±‚ï¼š

![image-20250317121733323](D:\app\typora\image-20250317121733323.png)

![image-20250317121803542](D:\app\typora\image-20250317121803542.png)

![image-20250317122358212](D:\app\typora\image-20250317122358212.png)

![image-20250317122522394](D:\app\typora\image-20250317122522394.png)

![image-20250317122747134](D:\app\typora\image-20250317122747134.png)

##### å¤šè·³é—®ç­”

â€œSource2Synthâ€ æ˜¯ â€œSource to Synthesisâ€ çš„ç®€å†™å½¢å¼ï¼Œâ€œSynthesisâ€ æ„æ€æ˜¯ â€œåˆæˆã€ç»¼åˆâ€ ï¼Œåœ¨è¿™ä¸ªè¯­å¢ƒä¸­å¯ä»¥ç†è§£ä¸ºå¯¹æ¥æºä¿¡æ¯è¿›è¡Œå¤„ç†ã€æ•´åˆåç”Ÿæˆæ–°çš„å†…å®¹

ç›®çš„ï¼šä»æºæ–‡æœ¬æ•°æ®åˆ›å»ºå¤šè·³é—®ç­”å¯¹ï¼Œç›®çš„æ˜¯ç”Ÿæˆæ•°æ®ã€‚æµç¨‹ï¼šå¤„ç†åŸå§‹æ–‡æœ¬ã€æå–ä¿¡æ¯å¯¹ï¼Œå¹¶ç”Ÿæˆå¤æ‚å¤šè·³æ¨ç†é—®é¢˜ï¼Œå¯é…ç½®å¤æ‚æ€§é˜ˆå€¼

æ„å»ºUserDataProcessorï¼Œ

![image-20250318225812377](D:\app\typora\image-20250318225812377.png)



#### æ¶ˆæ¯

- `role_name`ï¼šç”¨æˆ·æˆ–åŠ©ç†è§’è‰²çš„åç§°ã€‚
- `role_type`ï¼šè§’è‰²çš„ç±»å‹ï¼Œæˆ– ã€‚`RoleType.ASSISTANT``RoleType.USER`
- `meta_dict`ï¼šæ¶ˆæ¯çš„å¯é€‰å…ƒæ•°æ®å­—å…¸ã€‚
- `content`ï¼šæ¶ˆæ¯çš„å†…å®¹ã€‚

```python
message = BaseMessage( # åˆ›å»ºæ¶ˆæ¯
    role_name="test_user",
    role_type=RoleType.USER,
    content="test content"
)
```

æ¶ˆæ¯å¯ä»¥è¿›è¡Œç±»å‹è½¬æ¢ï¼Œæ¯”å¦‚è½¬ä¸ºopenaiä¸­ ç»™ç”¨æˆ·/ç»™åŠ©æ‰‹çš„æ¶ˆæ¯

åŒ…è£…å¥½æ¶ˆæ¯ä»¥åï¼Œå¯ä»¥ä¼ é€’åˆ°agentï¼Œå…¶ä¸­sys_msgç”¨äºåˆå§‹åŒ–agentï¼Œuser_msgç”¨äºä¼ é€’è¯·æ±‚

![image-20250317130953418](D:\app\typora\image-20250317130953418.png)

#### è®°å¿†

![image-20250318232921283](D:\app\typora\image-20250318232921283.png)

```python
# Create and write new records
records = [
    MemoryRecord(
        message=BaseMessage.make_user_message(
            role_name="User",
            meta_dict=None,
            content="What is CAMEL AI?",
        ),
        role_at_backend=OpenAIBackendRole.USER,
    ),
    MemoryRecord(
        message=BaseMessage.make_assistant_message(
            role_name="Agent",
            meta_dict=None,
            content="CAMEL-AI.org is the 1st LLM multi-agent framework and "
                    "an open-source community dedicated to finding the scaling law "
                    "of agents.",
        ),
        role_at_backend=OpenAIBackendRole.ASSISTANT,
    ),
]
memory.write_records(records)

# Set memory to the agent
agent.memory = memory

agent.memory.get_context()#è¯»å–è®°å¿†
#æ·»åŠ è®°å¿†
new_user_msg = BaseMessage.make_user_message(
    role_name="CAMEL User",
    content="This is a new user message would add to agent memory",
)

# Update the memory
agent.record_message(new_user_msg)
```

å…³é”®çš„ç±»ï¼šmemoryrecord, messagerecord, 

å…³äºè®°å¿†çš„å­˜å‚¨å’Œæ£€ç´¢ï¼š

![image-20250318235925431](D:\app\typora\image-20250318235925431.png)

ç±»ä¼¼åœ°ï¼Œæœ‰VectorDBBlockï¼Œæ˜¯æŠŠè®°å¿†å­˜å‚¨åœ¨å‘é‡

ä»–ä»¬å¦‚ä½•è¢«è°ƒç”¨ï¼šé€šè¿‡agentï¼Œæœ‰ChatHistoryMemoryå’ŒVectorDBMemoryã€‚ä¾‹å¦‚ï¼š

```python
memory = LongtermAgentMemory(
    context_creator=ScoreBasedContextCreator(
        token_counter=OpenAITokenCounter(ModelType.GPT_4O_MINI),
        token_limit=1024,
    ),
    chat_history_block=ChatHistoryBlock(),
    vector_db_block=VectorDBBlock(),
)
```

é€šå¸¸æ˜¯å…ˆæŠŠblockå°è£…åˆ°memoryï¼Œå†å¾€memoryæ·»åŠ recordã€‚ç„¶åæŠŠagentçš„memoryè®¾ç½®æˆè¿™ä¸ª

å…¶ä¸­ï¼Œmemory recordçš„ä¸»è¦ä¿¡æ¯å°±æ˜¯messageï¼ŒContextCreatorç”¨äºæ£€ç´¢åˆ°å¾ˆå¤šcontext recordï¼Œå…¶ä¸­æ¯ä¸ªrecordéƒ½åŒ…å«memory recordå’Œåˆ†æ•°

#### æç¤ºè¯

æ³¨æ„åˆ°ï¼ŒTaskSpecifyAgentä¸­æä¾›äº†å¾ˆå¤šæç¤ºè¯æ¨¡æ¿

```python
#åˆ›å»ºmodel
model = ModelFactory.create(
    model_platform=ModelPlatformType.OPENAI,
    model_type=ModelType.GPT_4O_MINI,
)
#åŸºäºmodelåˆ›å»ºagentï¼Œå¹¶æŒ‡å®štaskæ˜¯å’ŒAI_SOCIETYæœ‰å…³çš„
task_specify_agent = TaskSpecifyAgent(
    model=model, task_type=TaskType.AI_SOCIETY
)
#è®¾å®štaskä¸ºâ€œæ”¹å–„èˆå°è¡¨ç¾å’Œè¡¨æ¼”æŠ€å·§â€ï¼ŒåŠ©æ‰‹ä¸ºéŸ³ä¹å®¶ï¼Œè¿™æ ·å°±ä¼šè‡ªåŠ¨å¥—å…¥æ¨¡æ¿ï¼Œå¾—åˆ°prompt
specified_task_prompt = task_specify_agent.run(
    task_prompt="Improving stage presence and performance skills",
    meta_dict=dict(
        assistant_role="Musician", user_role="Student", word_limit=100
    ),
)
```

è‡ªå®šä¹‰æç¤ºè¯ï¼šå¯ä»¥ä½¿ç”¨ä»»æ„çš„å ä½è¯ï¼Œåé¢é€šè¿‡dictæ¥ä¼ é€’ä¿¡æ¯

```python
my_prompt_template = TextPrompt(
    'Here is a task: I\'m a {occupation} and I want to {task}. Help me to make this task more specific.'
)  # Write anything you would like to use as prompt template
task_specify_agent = TaskSpecifyAgent(
    model=model, task_specify_prompt=my_prompt_template
)
response = task_specify_agent.run(
    task_prompt="get promotion",
    meta_dict=dict(occupation="Software Engineer"),
)
```

ç›´æ¥è¾“å…¥æç¤ºè¯ï¼š

```python
# Generate programming languages
languages_prompt = CodePromptTemplateDict.GENERATE_LANGUAGES.format(num_languages=5)
#List the 5 most commonly used computer programming languages.
#Be concise. No explanation required.

# Generate coding tasks
tasks_prompt = CodePromptTemplateDict.GENERATE_TASKS.format(num_tasks=3)
#List 3 diverse tasks that a programmer can assist a person working in {domain} using {language}.
#Be concise. Be creative.

# Create an AI coding assistant promptï¼Œéœ€è¦è®¾å®šè§’è‰²ã€è¦æ‰§è¡Œçš„ä»»åŠ¡æè¿°
assistant_prompt = CodePromptTemplateDict.ASSISTANT_PROMPT.format(
    assistant_role="Python Expert",
    task_description="Implement a binary search algorithm",
)
```

å¾—åˆ°çš„åŠ©æ‰‹æç¤ºè¯ï¼š

```
Never forget you are a Computer Programmer and I am a person working in {domain}. Never flip roles! Never instruct me!
We share a common interest in collaborating to successfully complete a task.
You must help me to complete the task using {language} programming language.
Here is the task: {task}. Never forget our task!
I must instruct you based on your expertise and my needs to complete the task.

I must give you one instruction at a time.
You must write a specific solution that appropriately solves the requested instruction and explain your solutions.
You must decline my instruction honestly if you cannot perform the instruction due to physical, moral, legal reasons or your capability and explain the reasons.
Unless I say the task is completed, you should always start with:

Solution: <YOUR_SOLUTION>

<YOUR_SOLUTION> must contain {language} code and should be very specific, include detailed explanations and provide preferable implementations and examples for task-solving.
Always end <YOUR_SOLUTION> with: Next request.
```

EvaluationPromptTemplateDictï¼šç”¨äºç”Ÿæˆæç¤ºè¯ï¼Œåœ¨æŸä¸ªé¢†åŸŸï¼Œæ ¹æ®ç¤ºä¾‹é—®é¢˜è‡ªæ‹Ÿå¤šä¸ªé—®é¢˜

```python
questions_prompt = EvaluationPromptTemplateDict.GENERATE_QUESTIONS.format(
    num_questions=5,
    field="Machine Learning",
    examples="1. What is the difference between supervised and unsupervised learning?\n2. Explain the concept of overfitting.",
)
```

ç±»ä¼¼åœ°ï¼Œè¿˜æœ‰ä¸“é—¨ç”¨äºå¯¹è±¡è¯†åˆ«ã€ä¸“é—¨ ç”¨äºç¿»è¯‘çš„æç¤ºè¯

#### Task

å®šä¹‰ï¼šè¿™ä¸ªæ¯”æç¤ºæ›´é«˜ä¸€ä¸ªçº§åˆ«ï¼Œä¸€ä¸ªtaskå¯èƒ½åŒ…å«å¤šæ¬¡å¯¹è¯ã€‚ä¸€ä¸ªtaskå¯ä»¥ç”±å¤šä¸ªagentå…±åŒå®Œæˆï¼Œå¹¶å¯ä»¥åˆ†è§£

å¸¸ç”¨æ–¹æ³•ï¼šadd_subtaskï¼Œdecomposeï¼ˆåˆ†è§£ï¼‰ï¼Œcomposeï¼ˆæ ¹æ®å¾ˆå¤šç­”æ¡ˆç»„åˆå‡ºç­”æ¡ˆï¼‰

```python
#åˆ›å»ºtask
task = Task(
    content="Weng earns $12 an hour for babysitting. Yesterday, she just did 51 minutes of babysitting. How much did she earn?",
    id="0",
)
#è®¾ç½®å±‚æ¬¡ç»“æ„
root_task.add_subtask(sub_task_1)
#ç”¨agentè‡ªåŠ¨åˆ†è§£taskï¼Œå¾—åˆ°taskçš„åˆ—è¡¨
new_tasks = task.decompose(agent=agent, template=TASK_DECOMPOSE_PROMPT)
#è§£å†³å„ä¸ªtaskä»¥åï¼Œç”¨agentæ¥æ„å»ºç­”æ¡ˆ
task.compose(agent=agent, template=TASK_COMPOSE_PROMPT)
print(task.result)
```

TaskManagerï¼šå¯ä»¥å¯¹taskè®¾ç½®ä¾èµ–å…³ç³»ï¼Œåšæ‹“æ‰‘æ’åºï¼Œåševolveè¿›åŒ–ä»»åŠ¡ï¼ˆæ¯”å¦‚è®©æç¤ºè¯æ›´åŠ æ˜ç¡®ï¼‰

```python
task_manager = TaskManager(task)
evolved_task = task_manager.evolve(task, agent=agent)
```

#### Loaderæ•°æ®è¯»å–

Base IO æ¨¡å—ä¸“æ³¨äºä¸æ–‡ä»¶ç›¸å…³çš„åŸºæœ¬è¾“å…¥ / è¾“å‡º

Unstructured IOæä¾›äº†ç”¨äºè§£ææ–‡ä»¶æˆ– URLã€æ¸…ç†æ•°æ®ã€æå–ç‰¹å®šä¿¡æ¯ã€ä¸ºä¸åŒå¹³å°æš‚å­˜å…ƒç´ ä»¥åŠåˆ†å—å…ƒç´ çš„å·¥å…·ã€‚è¯¥æ¨¡å—çš„æ ¸å¿ƒåœ¨äºå…¶å…ˆè¿›çš„ ETL åŠŸèƒ½ï¼Œç”¨äºå¤„ç†éç»“æ„åŒ–æ•°æ®ï¼Œä½¿å…¶å¯ç”¨äºæ£€ç´¢å¢å¼ºç”Ÿæˆ ï¼ˆRAGï¼‰ ç­‰å„ç§åº”ç”¨ç¨‹åº

Firecrawl Reader æä¾›äº†ä¸€ä¸ª Python æ¥å£æ¥ä¸ Firecrawl API äº¤äº’ï¼Œå…è®¸ç”¨æˆ·å°†ç½‘ç«™è½¬æ¢ä¸ºå¤§å‹è¯­è¨€æ¨¡å‹ ï¼ˆLLMï¼‰ å°±ç»ªçš„ markdown æ ¼å¼

JinaURL Reader æ˜¯ Jina AI çš„ URL è¯»å–æœåŠ¡çš„ Python å®¢æˆ·ç«¯ï¼Œç»è¿‡ä¼˜åŒ–ï¼Œå¯ä» URL æä¾›æ›´æ¸…æ™°ã€å¯¹ LLM å‹å¥½çš„å†…å®¹

```python
#ç»“æ„åŒ–io
from camel.loaders import create_file_from_raw_bytes

# Read a pdf file from disk
with open("test.pdf", "rb") as file:
    file_content = file.read()

# Use the create_file function to create an object based on the file extension
file_obj = create_file_from_raw_bytes(file_content, "test.pdf")

# Once you have the File object, you can access its content
print(file_obj.docs[0]["page_content"])

#éç»“æ„åŒ–IO
uio = UnstructuredIO()
# Set example url
example_url = (
    "https://www.cnn.com/2023/01/30/sport/empire-state-building-green-"
    "philadelphia-eagles-spt-intl/index.html")
elements = uio.parse_file_or_url(example_url)#ä»URLè·å–æ•°æ®
print(("\n\n".join([str(el) for el in elements])))

example_dirty_text = ("\x93Some dirty text Ã¢â‚¬â„¢ with extra spaces and â€“ dashes.")

# Set clean options,æ ¹æ®é€‰é¡¹åšæ¸…ç†  
options = [
    ('replace_unicode_quotes', {}),
    ('clean_dashes', {}),
    ('clean_non_ascii_chars', {}),
    ('clean_extra_whitespace', {}),
]

cleaned_text = uio.clean_text_data(text=example_dirty_text,clean_options=options)

#åˆ†å—
staged_element = uio.stage_elements(elements=elements,stage_type="stage_for_baseplate")

#Chunkr Readerï¼Œç”¨äºè¯»PDF
chunkr = ChunkrReader()
task_id = chunkr.submit_task(#æ„å»ºtask
    file_path="/Users/enrei/Large Language Model based Multi-Agents- A Survey of Progress and Challenges.pdf",
    model="Fast",
    ocr_strategy="Auto",
    target_chunk_length=512,
)
task_output = chunkr.get_task_output(#æ ¹æ®task Idè·å¾—å†…å®¹
    task_id="7becf001-6f07-4f63-bddf-5633df363bbb"
)

#ä½¿ç”¨Jina Readerï¼Œè·å¾—markdown
jina_reader = JinaURLReader(return_format=JinaReturnFormat.MARKDOWN)
response = jina_reader.read_content("https://docs.camel-ai.org/")
```

#### Society

##### RolePlaying

ä¸ºä»€ä¹ˆè¿™æ ·åšï¼šå…‹æœäº†è®¸å¤šæŒ‘æˆ˜ï¼Œä¾‹å¦‚*è§’è‰²ç¿»è½¬*ã€*åŠ©æ‰‹é‡å¤æŒ‡ä»¤*ã€*ç‰‡çŠ¶å›å¤*ã€*æ¶ˆæ¯æ— é™å¾ªç¯*å’Œ*å¯¹è¯ç»ˆæ­¢æ¡ä»¶*

- æ°¸è¿œä¸è¦å¿˜è®°ä½ æ˜¯<ASSISTANT_ROLE>ï¼Œæˆ‘æ˜¯<USER_ROLE>ã€‚

  *è¿™ä¼šå°†æ‰€é€‰è§’è‰²åˆ†é…ç»™åŠ©ç†ä»£ç†ï¼Œå¹¶ä¸ºå…¶æä¾›æœ‰å…³ç”¨æˆ·è§’è‰²çš„ä¿¡æ¯ã€‚*

- æ°¸è¿œä¸è¦äº’æ¢è§’è‰²ï¼æ°¸è¿œä¸è¦æŒ‡ç¤ºæˆ‘ï¼

  *è¿™å¯ä»¥é˜²æ­¢ä»£ç†ç¿»è½¬è§’è‰²ã€‚åœ¨æŸäº›æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬è§‚å¯Ÿåˆ° Assistant å’Œç”¨æˆ·åˆ‡æ¢è§’è‰²ï¼Œå…¶ä¸­ Assistant çªç„¶æ¥ç®¡æ§åˆ¶æƒå¹¶æŒ‡ç¤ºç”¨æˆ·ï¼Œè€Œç”¨æˆ·åˆ™éµå¾ªè¿™äº›æŒ‡ç¤ºã€‚*

- å¦‚æœæ‚¨å› èº«ä½“ã€é“å¾·ã€æ³•å¾‹åŸå› æˆ–æ‚¨çš„èƒ½åŠ›è€Œæ— æ³•æ‰§è¡Œæˆ‘çš„æŒ‡ç¤ºï¼Œæ‚¨å¿…é¡»è¯šå®åœ°æ‹’ç»æˆ‘çš„æŒ‡ç¤ºï¼Œå¹¶è§£é‡ŠåŸå› ã€‚

  *è¿™ç¦æ­¢ä»£ç†åˆ¶ä½œæœ‰å®³ã€è™šå‡ã€éæ³•å’Œè¯¯å¯¼æ€§ä¿¡æ¯ã€‚*

- é™¤éæˆ‘è¯´ä»»åŠ¡å·²å®Œæˆï¼Œå¦åˆ™æ‚¨åº”è¯¥å§‹ç»ˆä»ä»¥ä¸‹ä½ç½®å¼€å§‹ï¼šè§£å†³æ–¹æ¡ˆï¼š<YOUR_SOLUTION>ã€‚<YOUR_SOLUTION>åº”è¯¥æ˜¯å…·ä½“çš„ï¼Œå¹¶ä¸ºä»»åŠ¡è§£å†³æä¾›æ›´å¯å–çš„å®ç°å’Œç¤ºä¾‹ã€‚

  *è¿™é¼“åŠ±åŠ©ç†å§‹ç»ˆä»¥ä¸€è‡´çš„æ ¼å¼è¿›è¡Œå›åº”ï¼Œé¿å…ä¸å¯¹è¯ç»“æ„æœ‰ä»»ä½•åå·®ï¼Œå¹¶é˜²æ­¢æ¨¡ç³Šæˆ–ä¸å®Œæ•´çš„å›åº”ï¼Œæˆ‘ä»¬ç§°ä¹‹ä¸ºç‰‡çŠ¶å›åº”ï¼Œä¾‹å¦‚â€œæˆ‘ä¼šåšæŸäº‹â€ã€‚*

- å§‹ç»ˆä»¥ä»¥ä¸‹æ–¹å¼ç»“æŸæ‚¨çš„è§£å†³æ–¹æ¡ˆï¼šNext requestã€‚

  *è¿™å¯ç¡®ä¿åŠ©æ‰‹é€šè¿‡è¯·æ±‚æ–°çš„æŒ‡ä»¤æ¥è§£å†³æ¥ä¿æŒå¯¹è¯çš„è¿›è¡Œã€‚*

##### äº¤æ›¿å¯¹è¯å®ä¾‹

```python
def main(model=None, chat_turn_limit=50) -> None:
# Initial the role-playing session on developing a trading bot task with default model (`GPT_4O_MINI`)
    task_prompt = "Develop a trading bot for the stock market"
    role_play_session = RolePlaying(
        assistant_role_name="Python Programmer",
        assistant_agent_kwargs=dict(model=model),
        user_role_name="Stock Trader",
        user_agent_kwargs=dict(model=model),
        task_prompt=task_prompt,
        with_task_specify=True,
        task_specify_agent_kwargs=dict(model=model),
    )

    n = 0
    input_msg = role_play_session.init_chat()#åˆå§‹åŒ–å¯¹è¯

# Output response step by step with different colors.
# Keep output until detect the terminate content or reach the loop limit.
    while n < chat_turn_limit:
        n += 1
        assistant_response, user_response = role_play_session.step(input_msg)

        if assistant_response.terminated:
            print(
                Fore.GREEN
                + (
                    "AI Assistant terminated. Reason: "
                    f"{assistant_response.info['termination_reasons']}."
                )
            )
            break
        if user_response.terminated:
            print(
                Fore.GREEN
                + (
                    "AI User terminated. "
                    f"Reason: {user_response.info['termination_reasons']}."
                )
            )
            break

        print_text_animated(
            Fore.BLUE + f"AI User:\n\n{user_response.msg.content}\n"
        )
        print_text_animated(
            Fore.GREEN + "AI Assistant:\n\n"
            f"{assistant_response.msg.content}\n"
        )

        if "CAMEL_TASK_DONE" in user_response.msg.content:
            break

        input_msg = assistant_response.msg

if __name__ == "__main__":
    main()
```

##### æ„å»ºsociety

```python
#è®¾ç½®taskçš„å†…å®¹ï¼Œä»¥åŠå¦‚ä½•æŠŠtaskè½¬ä¸ºprompt
task_kwargs = {
    'task_prompt': 'Develop a plan to TRAVEL TO THE PAST and make changes.',
    'with_task_specify': True,
    'task_specify_agent_kwargs': {'model': model}
}
society = RolePlaying(
    **task_kwargs,             # The task arguments
    **user_role_kwargs,        # The instruction sender's arguments
    **assistant_role_kwargs,   # The instruction receiver's arguments
)

#è®¾ç½®runå‡½æ•°ï¼Œä¼ å…¥society
def run(society, round_limit: int=10):

    # Get the initial message from the ai assistant to the ai user
    input_msg = society.init_chat()

    # Starting the interactive session
    for _ in range(round_limit):

        # Get the both responses for this round
        assistant_response, user_response = society.step(input_msg)

        # Check the termination condition
        if is_terminated(assistant_response) or is_terminated(user_response):
            break

        # Get the results
        print(f'[AI User] {user_response.msg.content}.\n')
        # Check if the task is end
        if 'CAMEL_TASK_DONE' in user_response.msg.content:
            break
        print(f'[AI Assistant] {assistant_response.msg.content}.\n')



        # ä¸ºä¸‹ä¸€å›åˆï¼Œæ›´æ–°input_msg
        input_msg = assistant_response.msg

    return None
```

#### æ£€ç´¢

ä¸¤ç§ç±»å‹ï¼šå‘é‡æ£€ç´¢ å…³é”®è¯æ£€ç´¢ï¼ˆåˆ†è¯ï¼Œä»æŸ¥è¯¢æå–ç›¸å…³å…³é”®å­—ï¼Œæœç´¢è¿™äº›å…³é”®å­—çš„å‡ºç°æ¬¡æ•°ï¼Œå¯¹è¿™äº›æ–‡æ¡£è¿›è¡Œæ’åï¼‰

```python
# Initialize the VectorRetriever with an embedding model
vr = VectorRetriever(embedding_model=OpenAIEmbedding())
vector_storage = QdrantStorage(#æ„å»ºå­˜å‚¨å™¨ï¼Œè®¾ç½®å­˜å‚¨è·¯å¾„
    vector_dim=OpenAIEmbedding().get_output_dim(),
    collection_name="my first collection",
    path="storage_customized_run",
)
# Embed and store chunks of data in the vector storage
vr.process(content_input_path, vector_storage)
#æ‰§è¡ŒæŸ¥è¯¢
query = "What is CAMEL"
# Execute the query and retrieve results
results = vr.query(query, vector_storage)
```

å¸¦æœ‰RAGçš„agentï¼š

```python
def single_agent(query: str) ->str :
    # Set agent role
    assistant_sys_msg = """You are a helpful assistant to answer question,
         I will give you the Original Query and Retrieved Context,
        answer the Original Query based on the Retrieved Context,
        if you can't answer the question just say I don't know."""

    # Add auto retriever
    auto_retriever = AutoRetriever(
            vector_storage_local_path="local_data2/",
            storage_type=StorageType.QDRANT,
            embedding_model=embedding_instance)

    retrieved_info = auto_retriever.run_vector_retriever(
        query=query,
        contents=[
            "local_data/camel_paper.pdf",  # example local path
            "https://github.com/camel-ai/camel/wiki/Contributing-Guidlines",  # example remote url
        ],
        top_k=1,
        return_detailed_info=False,
        similarity_threshold=0.5
    )

    # Pass the retrieved infomation to agent
    user_msg = str(retrieved_info)#æŠŠæ£€ç´¢åˆ°çš„ä¿¡æ¯æ”¾å…¥user_msg
    agent = ChatAgent(assistant_sys_msg)

    # Get response
    assistant_response = agent.step(user_msg)
    return assistant_response.msg.content
```

ç±»ä¼¼åœ°ï¼Œå¯ä»¥æŠŠRAGæ‰©å±•åˆ°å…·æœ‰å¤šä¸ªAGENTçš„ç¤¾ä¼š

### 2.2 å®ä¾‹

#### agentå’Œsocietyå¦‚ä½•ä½¿ç”¨å·¥å…·

```python
agent = ChatAgent(
    assistant_sys_msg,
    model=model,
    tools=tools_list
)
role_play_session = RolePlaying(
    assistant_role_name="Searcher",
    user_role_name="Professor",
    assistant_agent_kwargs=dict(
        model=ModelFactory.create(
            model_platform=ModelPlatformType.OPENAI,
            model_type=ModelType.GPT_4O_MINI,
        ),
        tools=tools_list,
    ),
    user_agent_kwargs=dict(
        model=ModelFactory.create(
            model_platform=ModelPlatformType.OPENAI,
            model_type=ModelType.GPT_4O_MINI,
        ),
    ),
    task_prompt=task_prompt,
    with_task_specify=False,
)
#åœ¨è¾“å‡ºä¸­å¯ä»¥çœ‹åˆ°å·¥å…·çš„è°ƒç”¨æƒ…å†µï¼š
Function Execution: sub
        Args: {'a': 2024, 'b': 1096}
        Result: 928
```

#### æ ‘æœç´¢

è¯„è®ºå®¶ä»£ç†è´Ÿè´£ é€‰æ‹©ææ¡ˆå¹¶å‘è§’è‰²æ‰®æ¼”ä»£ç†æä¾›ä¿¡æ¯ä¸°å¯Œçš„å£å¤´åé¦ˆ

<img src="D:\app\typora\image-20250319022249875.png" alt="image-20250319022249875" style="zoom:60%;" />

```python
critic_agent = CriticAgent(system_message=sys_msg, verbose=True)
task_kwargs = {
    'task_prompt': 'Develop a plan to TRAVEL TO THE PAST and make changes.',
    'with_task_specify': True,
    'task_specify_agent_kwargs': {'model': model}
}

user_role_kwargs = {
    'user_role_name': 'an ambitious aspiring TIME TRAVELER',
    'user_agent_kwargs': {'model': model}
}

assistant_role_kwargs = {
    'assistant_role_name': 'the best-ever experimental physicist',
    'assistant_agent_kwargs': {'model': model}
}

critic_role_kwargs = {
    'with_critic_in_the_loop': True,
    'critic_criteria': 'improve the task performance',
    'critic_kwargs': dict(verbose=True)
}
society = RolePlaying(
    **task_kwargs,             # The task arguments
    **user_role_kwargs,        # The instruction sender's arguments
    **assistant_role_kwargs,   # The instruction receiver's arguments
    **critic_role_kwargs,      # The critic's arguments
)
```



#### qwenä»£ç 

societyæ˜¯RolePlayingçš„å®ä¾‹ï¼Œæ³¨æ„åˆ°æœ‰é¢å¤–ä¼ é€’è¿™äº›å‚æ•°

![image-20250317132447133](D:\app\typora\image-20250317132447133.png)

æ„å»ºå¥½societyå°±è¿è¡Œå®ƒã€‚owl\utils\enhanced_role_playing.pyæœ‰init RolePlayingå’Œè¿è¡Œsocietyï¼Œä¸€èˆ¬æ¯ä¸ªæ–‡ä»¶ä¼šç”¨è‡ªå·±çš„å‚æ•°ä¼ å…¥RolePlayingè¿›è¡Œæ„å»ºï¼Œç„¶åè‡ªåŠ¨åŒ–è¿è¡Œsociety

å…·ä½“æ¥è¯´ï¼šæˆ‘ä»¬ä¸»è¦çœ‹æ–‡æ¡£çš„ä»£ç éƒ¨åˆ†ã€‚



## ä¸‰ã€å†™ä»£ç ï¼šæ„å»ºplanning

æ€è·¯æ˜¯ï¼ŒæŠŠç›¸å…³æ–‡ä»¶å¤åˆ¶è¿‡æ¥ï¼Œåœ¨é¡¹ç›®é‡Œimportè¿™ä¸ªè‡ªå®šä¹‰çš„åŒ…

åœ¨å“ªé‡Œè¿›è¡Œè§„åˆ’=ã€‹æ³¨æ„åˆ°modelé‡Œæœ‰planningï¼ˆè®¾ç½®äº†è¿™ä¸ªæ¨¡å‹ç”¨åƒé—®ï¼‰

æ³¨æ„åˆ°å¯ä»¥ç»™assistant_agent_kwargsè®¾ç½®å·¥å…·

è®¡åˆ’æŠŠä¾‹å­å…¨éƒ¨çœ‹ä¸€éå†å¼€å§‹å†™ã€‚





å‘¨äºŒä½ éœ€è¦åšä»€ä¹ˆï¼šåšå‡ºåˆç‰ˆï¼Œç»™å‡ºæ•ˆæœå›¾ï¼ˆç›¸å½“äºæœ€ä½ç¨‹åº¦çš„ç‰ˆæœ¬ï¼‰

